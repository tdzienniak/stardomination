<!DOCTYPE html>
<html>
    <head>
        <script src="js/preloadjs.min.js"></script>
        <script src="js/easeljs.min.js"></script>
        <script src="js/CSSClass.min.js"></script>
        <script src="js/vector.js"></script>
        <script src="js/ball.js"></script>
        <script src="js/module.js"></script>
        <script src="js/edge.js"></script>
        <script src="js/ship.js"></script>
        <script src="js/collisions.js"></script>
        <script src="js/background.js"></script>
        <script src="js/main.js"></script>
        <script src="js/menu-screen.js"></script>
        <script src="js/configuration-screen.js"></script>
        <script src="js/game-screen.js"></script>
        <script>
            var queue = new createjs.LoadQueue(true);
            queue.addEventListener("complete", handleComplete);
            queue.addEventListener("fileload", handleFileLoad);
            queue.loadManifest([
                'js/alert.js',
                /*'js/easeljs.min.js',
                'js/CSSClass.min.js',
                'js/vector.js',
                'js/ball.js',
                'js/module.js',
                'js/edge.js',
                'js/ship.js',
                'js/collisions.js',
                'js/background.js',
                'js/main.js',
                'js/menu-screen.js',
                'js/configuration-screen.js',
                'js/game-screen.js'*/
                ]);

            /*  Wykorzystanie Page Visibility API do pauzowania gry kiedy karta, w której jest otwarta traci "focus"
                Kod pochodzi ze strony https://developer.mozilla.org/en-US/docs/DOM/Using_the_Page_Visibility_API */
            var hidden, visibilityChange; 
            if (typeof document.hidden !== "undefined") { // Opera 12.10 and Firefox 18 and later support 
                hidden = "hidden";
                visibilityChange = "visibilitychange";
            } else if (typeof document.mozHidden !== "undefined") {
                hidden = "mozHidden";
                visibilityChange = "mozvisibilitychange";
            } else if (typeof document.msHidden !== "undefined") {
                hidden = "msHidden";
                visibilityChange = "msvisibilitychange";
            } else if (typeof document.webkitHidden !== "undefined") {
                hidden = "webkitHidden";
                visibilityChange = "webkitvisibilitychange";
            }

            document.addEventListener(visibilityChange, handleVisibilityChange, false);

            function handleComplete (event) {
                //var canvas = document.getElementById('mainCanvas');
                var settings = {};
                //sd.Game.init();
                sd.Game.showScreen("menu-screen");
                console.log('Załadowano wszystko!');
            }

            function handleFileLoad (event) {
                var item = event.item;
                var type = item.type;

                if (type == createjs.LoadQueue.JAVASCRIPT) {
                    document.body.appendChild(event.result);
                    //setTimeout(function () {}, 1000);
                }
            }

            function handleVisibilityChange () {
                if (document[hidden]) {
                    createjs.Ticker.setPaused(true);
                } else {
                    //createjs.Ticker.setPaused(false);
                }
            }
        </script>
        <style type="text/css">
            body {
                background: url('img/debut_dark.png') repeat;
            }
            canvas {
                /*background: black;*/
                position: relative;
                z-index: 10000;
            }

            #fps {
                font-family: calibri, sans-serif;
                color: white;
            }

            .info {
                padding: 10px 10px;
                height: 200px;
                width: 200px;
                font-family: calibri;
                color: white;
                text-align: left;
                background: rgb(40,40,40);
                position: absolute;
                top: 10px;
                left: 10px;
            }

            .screen {
                height: 600px;
                width: 800px;
                margin: 10px auto;
                border: 5px solid rgba(100,100,100,0.7);
                border-radius: 5px;
                box-shadow: 3px 3px 5px black;
                position: relative;
                display: none;
                cursor: url('cursors/cursor.cur'), default;
                background: black;
            }

            .active {
                display: block;
            }

            .not-active {

            }

            .menu-screen {
                text-align: center;
                
                padding-top: 200px;
                height: 400px;
            }

            .button {
                color: white;
                font-family: spaceman;
                font-size: 16pt;
                display: block;
                margin-top: 5px;
                text-shadow: 0px 0px 5px red;
                position: relative;
                z-index: 1000;
                padding: 3px 3px;
            }

            .title {
                font-family: NiseJSRF, sans-serif;
                font-size: 30pt;
                color: white;
                position: relative;
                top: -80px;
                z-index: 1000;
            }

            .button:hover  {
                background: rgba(255, 0, 0, 0.6);
            }

            #background {
                background: url('img/back.jpg');
                height: 600px;
                width: 800px;
                /*overflow: visible;*/
                position: absolute;
                top: 0px;
                left: 0px;
                z-index: 400;
            }

            #spaceNear, #spaceMiddle, #spaceFar {
                height: 600px;
                width: 800px;
                position: absolute;
                top: 0px;
                left: 0px;
                z-index: 500;
            }

            #spaceNear {
                background: url('img/spaceNear.png');
            }

            #spaceFar {
                background: url('img/spaceFar.png');
            }

            #spaceMiddle {
                background: url('img/spaceMiddle.png');
            }

            #fps {
                position: absolute;
                top: 5px;
                right: 5px;
            }

            .configuration-screen {
                padding: 30px 30px;
                height: 540px;
                width: 740px;
            }

            .ui-text-box {
                font-family: spaceman;
                font-size: 12pt;
                text-shadow: 0px 0px 3px red;
                padding: 10px 0px;
                text-align: center;
               
                color: white;
                margin-bottom: 30px;
                background: rgb(100,100,100);
                position: relative;
            }

            .ui-text-box-gradient {
                background-image: linear-gradient(left , rgb(100,100,100) 0%, transparent 50%, rgb(100,100,100) 100%);
                background-image: -o-linear-gradient(left , rgb(100,100,100) 0%, transparent 50%, rgb(100,100,100) 100%);
                background-image: -moz-linear-gradient(left , rgb(100,100,100) 0%, transparent 20%, transparent 80%, rgb(100,100,100) 100%);
                background-image: -webkit-linear-gradient(left , rgb(100,100,100) 0%, transparent 20%, transparent 80%, rgb(100,100,100) 100%);
                background-image: -ms-linear-gradient(left , rgb(100,100,100) 0%, transparent 50%, rgb(100,100,100) 100%);

                background-image: -webkit-gradient(
                    linear,
                    left top,
                    right top,
                    color-stop(0, rgb(100,100,100)),
                    color-stop(0.3, transparent),
                    color-stop(0.7, transparent),
                    color-stop(1, rgb(100,100,100))
                );

                height: 100%;
                width: 100%;
                position: absolute;
                top: 0px;
            }

            .ui-window {
                height: 400px;
                width: 740px;
                position: relative;
            }

            .ui-tabs {
                height: 30px;
                width: inherit;
                position: absolute;
                top: 0px;
                left: 0px;
            }

            .ui-tab-content {
                height: 370px;
                width: inherit;
                position: absolute;
                top: 30px;
                left: 0px;
                background: rgb(100,100,100);
                box-shadow: 0px 0px 3px black;
                z-index: 850;
                /*border: 1px solid white;*/
            }

            .ui-tab {
                height: inherit;
                display: inline-block;
                position: relative;
            }

            .ui-tab-body {
                height: inherit;
                text-align: center;
                float: left;
                position: relative;
                box-shadow: 0px 0px 5px black;
                z-index: 600;
                background: rgb(70,70,70);
                /*border-top: 1px solid white;
                border-left: 1px solid white;*/
            }

            .ui-tab-body span {
                font-family: spaceman;
                font-size: 12pt;
                color: white;
                text-shadow: 0px 0px 3px blue;
                position: relative;
                top: 5px;
                padding-left: 10px;
                padding-right: 5px;
            }
            .ui-tab-end {
                width: 15px;
                height: inherit;
                overflow: hidden;
                /*background: url("img/tab-end-inactive.png");*/
                float: left;
                position: relative;          
            }

            .next-tab {
                margin-left: -12px;
            }

            .triangle {
                height: 40px;
                width: 20px;
                -webkit-transform: rotate(-23deg);
                -moz-transform: rotate(-23deg);
                position: relative;
                top: 1px;
                left: -11px;
                box-shadow: 0px 0px 5px black;
                background: rgb(70,70,70);
                z-index: 700;
                /*border-right: 1px solid white;*/
            }

            .active-tab {
                z-index: 900;
            }

            .active-background {
                background: rgb(100,100,100);
            }

            .shadow-cover {
                width: inherit;
                height: 5px;
                background: rgb(100,100,100);
                position: absolute;
                top: 30px;
                z-index: 950;
            }

            .ui-button {
                padding: 10px 10px;
                background: rgb(100,100,100);
                font-family: spaceman;
                font-size: 12pt;
                text-shadow: 0px 0px 3px red;
                color: white;
                text-align: center;
                width: 100px;
                float: left;
                margin-top: 30px;
                position: relative;
                z-index: 1000;
            }

            .battle-button {
                float: right;
                background: rgb(180, 15, 15);
                text-shadow: 0px 0px 3px black;
            }
        </style>
    </head>
    <body>
        <span id="fps"></span>
        <div class="menu-screen screen">
            <span class="title">star domination</span>
            <span class="button">new game</span>
            <span class="button">options</span>
            <span class="button">about</span>
            <div id="spaceNear">
            </div>
            <div id="spaceMiddle">
            </div>
            <div id="spaceFar">
            </div>
        </div>
        <div class="configuration-screen screen">
            <div class="ui-text-box"><div class="ui-text-box-gradient"></div>configure your starship</div>
            <div class="ui-window">
                <div class="ui-tabs">
                    <div class="ui-tab ">
                        <div class="ui-tab-body"><span>hull</span></div><div class="ui-tab-end"><div class="triangle"></div></div>
                    </div>
                    <div class="ui-tab next-tab active-tab">
                        <div class="ui-tab-body active-background"><span>wings</span></div><div class="ui-tab-end"><div class="triangle active-background"></div></div>
                    </div>
                    <div class="ui-tab next-tab">
                        <div class="ui-tab-body not-active-background"><span>front</span></div><div class="ui-tab-end"><div class="triangle"></div></div>
                    </div>
                    <div class="ui-tab next-tab">
                        <div class="ui-tab-body not-active-background"><span>rear</span></div><div class="ui-tab-end"><div class="triangle"></div></div>
                    </div>
                </div>
                <div class="ui-tab-content"></div>
                <div class="shadow-cover"></div>
            </div>
            <div class="ui-button" id="back-to-menu">back</div><div class="ui-button battle-button" id="battle">Battle!</div>
            <div id="spaceNear">
            </div>
            <div id="spaceMiddle">
            </div>
            <div id="spaceFar">
            </div>
        </div>
        <div class="game-screen screen">
            <canvas id="mainCanvas" width="800" height="600">
            </canvas>
        </div>
        <div class="info">
            Move mouse to rotate the starship. Click to accelerate.<br /><br />
            <span id="mousePosition"></span>
            <button onclick="createjs.Ticker.setPaused(true)">Pause</button>
            <button onclick="createjs.Ticker.setPaused(false)">Play</button>
        </div>
    </body>
</html>